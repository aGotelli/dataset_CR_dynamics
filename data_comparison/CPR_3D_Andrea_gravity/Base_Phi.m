function [Phi] = Base_Phi(X,Config)
    
    i_limb = Config.robot.limb.i_limb;

    X = X/Config.robot.limb.l(i_limb);

% ---- Legendre ------%    
    

M_cheb = [  1    0     0      0       0        0        0        0        0        0      0;
           -1    2     0      0       0        0        0        0        0        0      0;
            1   -6     6      0       0        0        0        0        0        0      0;
           -1   12   -30     20       0        0        0        0        0        0      0;
            1  -20    90   -140      70        0        0        0        0        0      0;
           -1   30  -210    560    -630      252        0        0        0        0      0;
            1  -42   420  -1680    3150    -2772      924        0        0        0      0;
           -1   56  -756   4200  -11550    16632   -12012     3432        0        0      0;
            1  -72  1260  -9240   34650   -72072    84084   -51480    12870        0      0;
           -1   90 -1980  18480  -90090   252252  -420420   411840  -218790    48620      0;
            1 -110  2970 -34320  210210  -756756  1681680 -2333760  1969110  -923780 184756;
           ];
% ------ cheb ------ %    
%     poids = ((4/pi)^(1/2))*(1-(2*X-1)^2)^(-1/4);
% poids = 1;
%     M_cheb = poids*[  1    0     0      0       0        0        0        0        0        0      0;
%                -1    2     0      0       0        0        0        0        0        0      0;
%                 1   -8     8      0       0        0        0        0        0        0      0;
%                -1   18   -48     32       0        0        0        0        0        0      0;
%                 1  -32   160   -256     128        0        0        0        0        0      0;
%                -1   50  -400   1120   -1280      512        0        0        0        0      0;
%                 1  -72   840  -3584    6912    -6144     2048        0        0        0      0;
%                -1   98 -1568   9408  -26880    39424   -28672     8192        0        0      0;
%                 1 -128  2688 -21504   84480  -180224   212992  -131072    32768        0      0;
%                -1  162 -4320  44352 -228096   658944 -1118208  1105920  -589824   131072      0;
%                 1 -200  6600 -84480  549120 -2050048  4659200 -6553600  5570560 -2621440 524288;
%                ];
%      M_cheb = eye(11);

    Base = M_cheb*[1 X X^2 X^3 X^4 X^5 X^6 X^7 X^8 X^9 X^10]';
%     Base = [cos(2*pi*X);Base];
%     Base = [sin(2*pi*X);Base];
    Phi = [];
    for it = 1:6
        [n , m] = size(Phi);
        if Config.robot.limb.V_a(it)==1            
            Phi = [Phi,                           zeros(n,1);
                   zeros(Config.robot.limb.dim_base_k(it),m), Base(1:Config.robot.limb.dim_base_k(it))];
        end
    end
